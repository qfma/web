+++
date = 2014-09-22T21:35:34Z
draft = false
title = "Primate DUF1220 analysis"
description = "Analysis of the evolution of the DUF1220 domain"
+++

---------------------------------------

#### Update 2014-10-06

- Added three additional genomes from Pre-Ensembl
- Added three exomes
- Updated to Ensembl version 77

---------------------------------------


This document decscribes every command used to analyse the distribution of the DUF1220([PF06758](http://pfam.xfam.org/family/duf1220)) protein domains across various primates.
The analyis and pipeline is based on some of the methods described by [O'Bleness et al.](http://g3journal.org/content/2/9/977). The main difference to th O'Bleness paper is, 
that BLAST has been replaced by nucleotide hidden markov models.

### Primate sequences used

**[Ensembl](http://www.ensembl.org/index.html)** version 77:

1. Homo sapiens (Humans)
2. Pan troglodytes (Common Chimpanzees)
3. Gorilla gorilla (Gorilla)
4. Pongo abelii (Orangutan)
5. Nomascus leucogenys (Gibbon)
6. Macaca mulatta (Rhesus Macaque)
7. Tarsius syrichta (Tarsier)
8. Microcebus murinus (Mouse lemur)
9. Otolemur garnettii (Bushbaby)
10. Callithrix jacchus (Marmoset)
11. Papio anubis (Olive baboon)
12. Chlorocebus sabaeus (Green Vervet monkey)

**[Pre-Ensembl](http://pre.ensembl.org/index.html)**:

13. Macaca fasicularis (Crab-eating macaque)
14. Papio hamadryas (Hamadryas baboon)
15. Saimiri boliviensis (Squirrel monkey)


**George et al. exomes:**

Paper is [here](http://genome.cshlp.org/content/21/10/1686.full) and data should be available [here](http://depts.washington.edu/swansonw/Swanson_Lab/Data.html)

**Note**: This requires a fucking propietory piece of crappy software that kills my internet connection. Yes, it kills my router, my modem, my computer.

16. Chlorocebus aethiops (Grivet velvet monkey)
17. Colobus angolensis (Angola colobus)
18. Saguinus midas (red-handed tamarin)
19. Macaque (duplication Ensembl)

**MISC genomes:**

18. Homo neanderthalensis (Neanderthal) [Data download](http://neandertal.ensemblgenomes.org/index.html)

**Note:** Only BAM alignments?

19. Pan paniscus (Bonobo) [here](http://www.eva.mpg.de/bonobo-genome/data.html)

20. Daubentonia madagascariensis (Aye-aye): Paper is [here](http://gbe.oxfordjournals.org/content/4/2/126.long) data is [here](http://giladlab.uchicago.edu/data/AyeAyeGenome/)


### DUF1220 proteome annotation

The DUF1220([PF06758](http://pfam.xfam.org/family/duf1220)) seed alignment was downloaded from the PFAM database [here](http://pfam.xfam.org/family/duf1220#tabview=tab3).
The hidden markov model was built using HMMER 3.1b1.

``` bash
hmmbuild -n duf1220_seed --cpu 8  PF06758_seed.hmm PF06758_seed.txt
```

The PF06758_seed.hmm was used to search the proteomes of all 11 Ensembl primate genomes using ```hmmsearch``` with the gathering threshold.
Only the longest isoform was used for all proteomes.

``` bash
# Make longest isoforms
./get-longest-isoform.py sequences/pep sequences/pep
# Run hmmsearch against all proteomes
./hmmsearch-vs-pep-all-longest.sh
```
The output domtblout and tblout files were stored in ```2014-10-06-hmmsearch-vs-pep-all-longest```

``` bash
# Count the number of annotated domains
./get-peptide-domain-count.sh
Callithrix_jacchus: 15
Chlorocebus_sabaeus: 22
Gorilla_gorilla: 44
Homo_sapiens: 249
Macaca_mulatta: 23
Microcebus_murinus: 3
Nomascus_leucogenys: 6
Otolemur_garnettii: 3
Pan_troglodytes: 41
Papio_anubis: 18
Pongo_abelii: 21
Tarsius_syrichta: 10
```

### Extracting nucleotide alignments of DUF1220 from protein domain annotation

In order to detect DUF1220 in all species where protein translations are not available, we extracted the nucleotide sequences that correspond to
the position of the DUF1220 domains. This information is extracted from the *.domtblout files.

``` bash
./get-all-positions.sh
```

The output is stored in ```2014-10-06-duf1220-all-ensembl-nucl```.  Alignment is done with ```mafft```, nucl hmm build with ```hmmbuild```

### Verification of domains using cDNA

Numbers should be comparable to the peptide ones. Unclear at the moment why the general count increases.
Cutoff is 1e-10

``` bash
./nhmmer-vs-cdna-all-longest.sh
./get-nucleotide-domain-count.sh
Callithrix_jacchus: 15
Chlorocebus_sabaeus: 23
Gorilla_gorilla: 46
Homo_sapiens: 318
Macaca_mulatta: 23
Microcebus_murinus: 2
Nomascus_leucogenys: 6
Otolemur_garnettii: 2
Pan_troglodytes: 48
Papio_anubis: 17
Pongo_abelii: 23
Tarsius_syrichta: 7
```

### Pseudogenes in humans

The large number of domains found via cDNA can be explained through the presence of partly overlapping scaffolds that contain pseudogenes:

```text
ENST00000619932,ENSG00000272150,7,transcribed_unprocessed_pseudogene
ENST00000617931,ENSG00000268043,14,protein_coding
ENST00000577412,ENSG00000266338,7,protein_coding
ENST00000609741,ENSG00000273136,11,protein_coding
ENST00000453025,ENSG00000227001,3,unprocessed_pseudogene
ENST00000318220,ENSG00000142794,6,protein_coding
ENST00000613157,ENSG00000196427,4,protein_coding
ENST00000615421,ENSG00000269713,11,protein_coding
ENST00000612480,ENSG00000275131,1,unprocessed_pseudogene
ENST00000583271,ENSG00000270231,11,unprocessed_pseudogene
ENST00000369373,ENSG00000162825,68,protein_coding
ENST00000449715,ENSG00000203825,1,unprocessed_pseudogene
ENST00000621744,ENSG00000271383,46,protein_coding
ENST00000612520,ENSG00000213240,7,protein_coding
ENST00000444082,ENSG00000227242,5,unprocessed_pseudogene
ENST00000425093,ENSG00000231382,2,unprocessed_pseudogene
ENST00000294652,ENSG00000186086,4,protein_coding
ENST00000357046,ENSG00000243967,2,transcribed_unprocessed_pseudogene
ENST00000615281,ENSG00000263956,9,protein_coding
ENST00000401087,ENSG00000179571,7,unprocessed_pseudogene
ENST00000583866,ENSG00000271425,44,protein_coding
ENST00000445758,ENSG00000215864,2,unprocessed_pseudogene
ENST00000430580,ENSG00000219481,10,protein_coding
ENST00000619423,ENSG00000270629,34,protein_coding
ENST00000590707,ENSG00000205449,2,transcribed_unprocessed_pseudogene
Protein_coding_domains,275
Pseudogene_domains,43
```


### NHMMER search against toplevel dna

Cutoff is 1e-10, because of similar phylogenetic distance.

```bash
./nhmmer-vs-dna.sh
./get-dna-domain-count.sh
Callithrix_jacchus: 75
Chlorocebus_aethiops_ex: 0
Chlorocebus_sabaeus: 48
Colobus_angolensis_ex: 0
Deubetonia_madagascariensis: 26
Gorilla_gorilla: 97
Homo_sapiens: 295
Macaca_fascicularis: 67
Macaca_fascicularis_ex: 45
Macaca_mulatta: 75
Macaca_mulatta_ex: 43
Microcebus_murinus: 4
Nomascus_leucogenys: 59
Otolemur_garnettii: 7
Pan_paniscus: 34
Pan_troglodytes: 138
Papio_anubis: 76
Papio_hamadryas: 39
Pongo_abelii: 101
Saguinus_midas_ex: 0
Saimiri_boliviensis: 20
Tarsius_syrichta: 62
```

